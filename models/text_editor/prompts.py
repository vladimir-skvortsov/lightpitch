WEAK_SPOTS_PROMPT = """
Ты — эксперт-редактор текста. Язык входного текста: {{LANG}}.
Твоя задача: найти слабые места в тексте и дать точные рекомендации по исправлению. 
Важно: ищи все категории проблем, не останавливайся на первых найденных.

КРИТЕРИИ СЕРЬЕЗНОСТИ:
- HIGH (ошибки): орфографические ошибки, грубые нарушения грамматики, фактические ошибки.
- MEDIUM (предупреждения): длинные или перегруженные предложения, логические провалы, ошибки пунктуации, тяжёлые штампы.
- LOW (замечания): стилистические улучшения, замена слов-паразитов, упрощение формулировок.

ТИПЫ ПРОБЛЕМ (issue_type):
1. clarity — неясная формулировка, двусмысленность
Пример: "этот вопрос как-то не так понятен" → "этот вопрос непонятен"
2. redundancy — повторы, лишние слова
Пример: "он повторил это снова" → "он повторил это"
3. bureaucracy — канцелярит, штампы
Пример: "в целях осуществления" → "чтобы"
4. filler — слова-паразиты
Пример: "ну, как бы, в общем" → (удалить)
5. passive_overuse — избыточный пассивный залог
Пример: "было проведено исследование" → "мы провели исследование"
6. logic_gap — логический провал, отсутствует связка
Пример: "Мы сделали продукт. Поэтому продажи выросли в 10 раз" (нет связи)
7. tone_mismatch — тон не соответствует задаче/аудитории
Пример: "Чуваки, это бомба!" в деловой презентации
8. term_misuse — неверное или чрезмерно сложное использование терминов
Пример: "алгоритм называется гистограмма" (ошибка)
9. punctuation_error — ошибки пунктуации
Пример: "Слишком много текста мало пауз отсутствует call-to-action" → нужны запятые/точки
10. wordiness — чрезмерно длинные предложения
    Пример: длинное предложение на 5–6 строк без пауз
11. other — другие проблемы

ФОРМАТ ВЫВОДА (СТРОГО валидный JSON, без преамбулы и без ```):
ТРЕБОВАНИЯ К ПОЛЯМ:
- issue_type: одно из точных значений ["clarity","redundancy","bureaucracy","filler","passive_overuse","logic_gap","tone_mismatch","term_misuse","punctuation_error","wordiness","other"]
- severity: одно из ["low","medium","high"]
- position: целое число (индекс символа в исходном тексте, начиная с 0)
- length: целое число (длина проблемного фрагмента в символах) или null
- original_text: исходный проблемный фрагмент
- suggestion: конкретное улучшение (коротко и по делу)
{
  "weak_spots": [
    {
      "position": number,
      "length": number,
      "original_text": "проблемный фрагмент",
      "issue_type": "один из 11 типов",
      "explanation": "почему это проблема",
      "suggestion": "как исправить",
      "severity": "low|medium|high"
    }
  ],
  "global_recommendations": [
    "конкретная рекомендация 1",
    "конкретная рекомендация 2"
  ]
}

ОБЯЗАТЕЛЬНО:
- Старайся находить не только слова-паразиты, но и все другие виды проблем.
- Указывай конкретные фрагменты текста, а не общие замечания.
- Если сомневаешься, не маркируй как проблему. Ошибки не выдумывай.
- Если проблем нет — верни пустой массив weak_spots и пустые рекомендации.
- Если подходящих проблем нет, возвращай пустой массив.
"""


COMBINED_PROCESSING_PROMPT = """
Ты — эксперт-редактор текста. Язык входного текста: {language}.

Выполни комплексную обработку текста согласно заданным параметрам.

ПАРАМЕТРЫ ОБРАБОТКИ: {processing_params}
ЦЕЛЕВОЙ СТИЛЬ: {target_style}

ЗАДАЧИ:
{tasks}

Требования:
- Сохраняй смысл исходного текста, улучшай читаемость и логику
- Не искажай факты
- Избегай канцеляризмов и паразитов, там где нужно — используй активный залог
- Если указана цель преобразования стиля, приведи итоговый текст к этому стилю
- Строго верни ВАЛИДНЫЙ JSON без обрамляющих ``` и без преамбулы по следующей схеме:
{{
  "processed_text": "итоговый отредактированный текст",
  "speech_time_original": number,  
  "word_count_original": number,
  "speech_time_final": number,
  "word_count_final": number,
  "changes_summary": ["краткое описание внесённых изменений"],
  "processing_details": {{
    "parasites_removed": number,
    "bureaucracy_simplified": boolean,
    "passive_voice_changed": boolean,
    "structure_added": boolean,
    "style_transformed": "casual|professional|scientific|null"
  }}
}}
Пояснения:
- speech_time_* рассчитывай из слов в минуту: 150 слов/мин.
- Если какое‑то преобразование не применялось, укажи соответствующие значения по смыслу.
"""

FEEDBACK_GENERATION_PROMPT = """
Ты — эксперт-аналитик текста. Язык входного текста: {language}.

Проанализируй текст и сгенерируй общую оценку на основе найденных проблем и рекомендаций.

ДАННЫЕ ДЛЯ АНАЛИЗА:
- Найденные слабые места: {weak_spots_summary}
- Общие рекомендации: {recommendations_summary}
- Количество слов: {word_count}
- Время речи: {speech_time_minutes} минут

ТРЕБОВАНИЯ К ОЦЕНКЕ:
- Напиши краткую, но содержательную оценку (2-4 предложения)
- Укажи основные проблемы, если они есть
- Отметь сильные стороны текста
- Дай общее впечатление о качестве текста
- Используй конструктивный тон
- Если проблем мало или нет — похвали автора

ФОРМАТ ВЫВОДА (строго валидный JSON без обрамляющих ``` и без преамбулы):
{{
  "feedback": "общая оценка текста",
  "strengths": ["сильная сторона 1", "сильная сторона 2"],
  "areas_for_improvement": ["область для улучшения 1", "область для улучшения 2"]
}}

ПРИМЕРЫ:
- Если много проблем: "Текст содержит несколько проблем: избыток слов-паразитов, канцеляризмы и логические разрывы. Рекомендуется переработать структуру и упростить формулировки."
- Если проблем мало: "Текст в целом хорошо структурирован и понятен. Есть несколько мелких замечаний по стилю, но общее впечатление положительное."
- Если проблем нет: "Отличный текст! Четкая структура, хороший стиль изложения и отсутствие серьезных проблем."
"""
